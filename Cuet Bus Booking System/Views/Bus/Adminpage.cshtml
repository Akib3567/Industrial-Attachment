
@{
    
    ViewData["Title"] = "CUET Bus Management";

    var buses = new List<dynamic>
    {
        new { Id = 1, Name = "Padma", Seats = 40, Schedule = "8:00 AM - Campus to City" },
        new { Id = 2, Name = "Jamuna", Seats = 40, Schedule = "9:00 AM - Campus to City" },
        new { Id = 3, Name = "Buriganga", Seats = 40, Schedule = "5:00 PM - City to Campus" }
    };
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3><strong>CUET Bus Management</strong></h3>
        <a href="/logout" class="text-decoration-none">
            <i class="bi bi-box-arrow-right"></i> Logout
        </a>
    </div>

    <p>Welcome, <strong>Admin User</strong></p>

    <div class="btn-group mb-4" role="group">
        <button class="btn btn-primary">Manage Buses</button>
        <button class="btn btn-outline-primary">View Bookings</button>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">Bus Management</h5>
        <button class="btn btn-success" id="showAddFormBtn">
            <i class="bi bi-plus-lg"></i> Add Bus
        </button>
    </div>

    <!-- Add New Bus Form -->
    <div class="card mb-4 d-none" id="addBusForm">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">Add New Bus</h5>
                <button class="btn-close" id="closeAddFormBtn"></button>
            </div>

            <form id="addBusFormData">
                <div class="mb-3">
                    <label class="form-label">Bus Name</label>
                    <input type="text" class="form-control" placeholder="Enter Bus Name">
                </div>
                <div class="mb-3">
                    <label class="form-label">Total Seats</label>
                    <input type="number" class="form-control" placeholder="Enter Total Seats">
                </div>
                <div class="mb-3">
                    <label class="form-label">Schedule</label>
                    <input type="text" class="form-control" placeholder="e.g., 8:00 AM - Campus to City">
                </div>

                <div class="d-flex">
                    <button type="button" class="btn btn-primary w-50 me-2">Add Bus</button>
                    <button type="button" class="btn btn-secondary w-50" id="cancelAddBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Bus Form -->
    <div class="card mb-4 d-none" id="editBusForm">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">Edit Bus</h5>
                <button class="btn-close" id="closeEditFormBtn"></button>
            </div>

            <form id="editBusFormData">
                <div class="mb-3">
                    <label class="form-label">Bus Name</label>
                    <input type="text" id="editBusName" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Total Seats</label>
                    <input type="number" id="editBusSeats" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Schedule</label>
                    <input type="text" id="editBusSchedule" class="form-control">
                </div>

                <div class="d-flex">
                    <button type="button" class="btn btn-primary w-50 me-2">Update Bus</button>
                    <button type="button" class="btn btn-secondary w-50" id="cancelEditBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bus List -->
    @foreach (var bus in buses)
    {
        <div class="card mb-3 shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="card-title mb-1">@bus.Name</h5>
                    <p class="mb-0 text-muted">Total Seats: @bus.Seats</p>
                    <small>@bus.Schedule</small>
                </div>
                <div>
                    <button class="btn btn-outline-primary btn-sm me-2 edit-btn"
                            data-id="@bus.Id"
                            data-name="@bus.Name"
                            data-seats="@bus.Seats"
                            data-schedule="@bus.Schedule">
                        <i class="bi bi-pencil-square"></i>
                    </button>
                    <button class="btn btn-outline-danger btn-sm">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>
        </div>
    }
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

@section Scripts {
    <script>
        const addForm = document.getElementById("addBusForm");
        const editForm = document.getElementById("editBusForm");
        const showAddFormBtn = document.getElementById("showAddFormBtn");
        const closeAddFormBtn = document.getElementById("closeAddFormBtn");
        const cancelAddBtn = document.getElementById("cancelAddBtn");
        const closeEditFormBtn = document.getElementById("closeEditFormBtn");
        const cancelEditBtn = document.getElementById("cancelEditBtn");

        // Show Add Form
        showAddFormBtn.addEventListener("click", () => {
            addForm.classList.remove("d-none");
            editForm.classList.add("d-none");
        });

        // Hide Add Form
        [closeAddFormBtn, cancelAddBtn].forEach(btn => {
            btn.addEventListener("click", () => addForm.classList.add("d-none"));
        });

        // Show Edit Form
        document.querySelectorAll(".edit-btn").forEach(btn => {
            btn.addEventListener("click", (e) => {
                const name = btn.dataset.name;
                const seats = btn.dataset.seats;
                const schedule = btn.dataset.schedule;

                document.getElementById("editBusName").value = name;
                document.getElementById("editBusSeats").value = seats;
                document.getElementById("editBusSchedule").value = schedule;

                addForm.classList.add("d-none");
                editForm.classList.remove("d-none");
            });
        });

        // Hide Edit Form
        [closeEditFormBtn, cancelEditBtn].forEach(btn => {
            btn.addEventListener("click", () => editForm.classList.add("d-none"));
        });
    </script>
}
